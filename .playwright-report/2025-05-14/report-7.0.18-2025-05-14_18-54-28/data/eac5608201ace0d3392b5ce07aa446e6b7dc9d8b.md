# Test info

- Name: Smoke test Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† >> Ø¨Ø±Ø±Ø³ÛŒ ØµÙØ­Ù‡: ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØºÛŒÛŒØ±Ø§Øª
- Location: C:\Users\m.cheraghian\Desktop\simorgh-tests-playwright\tests\admin\smoke.spec.ts:51:9

# Error details

```
Error: expect(received).toContain(expected) // indexOf

Expected substring: "/login"
Received string:    "https://crm7.simorgh34000.test/admin/pages/change-log"
    at C:\Users\m.cheraghian\Desktop\simorgh-tests-playwright\tests\admin\smoke.spec.ts:129:21
```

# Test source

```ts
   29 |   { name: 'Ú¯Ø²Ø§Ø±Ø´ Ø¬ÙˆØ§ÛŒØ² Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', path: '/admin/administration/gamification/reports/personAwardReport', api: '/api/awardreports' },
   30 |   { name: 'Ú¯Ø²Ø§Ø±Ø´ Ø±ÙØªØ§Ø±Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', path: '/admin/administration/gamification/reports/personBehaviorReport', api: '/api/behaviorreports' },
   31 |   { name: 'Ú¯Ø²Ø§Ø±Ø´Ø§Øª Ø¬Ù…Ø¹ÛŒØªÛŒ', path: '/admin/reports/demographic', api: '/api/demographic' },
   32 | ];
   33 |
   34 | // ------------------------------------
   35 | // ØªØ¹Ø±ÛŒÙ Base URL
   36 | // ------------------------------------
   37 | const baseUrl = 'https://crm7.simorgh34000.test';
   38 |
   39 | // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø±
   40 | const pageTimeout = 120000; // 2 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø§ÛŒ Ù‡Ø± ØµÙØ­Ù‡
   41 | const navigationTimeout = 60000; // 1 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù†Ø§ÙˆØ¨Ø±ÛŒ
   42 |
   43 | // ------------------------------------
   44 | // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ - Ø¨Ù‡ ØµÙˆØ±Øª Ù…ÙˆØ§Ø²ÛŒ
   45 | // ------------------------------------
   46 | test.describe('Smoke test Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†', () => {
   47 |   // ------------------------------------
   48 |   // ØªØ³Øª ØµÙØ­Ø§Øª Ø§Ø¯Ù…ÛŒÙ† - Ø¨Ù‡ ØµÙˆØ±Øª Ù…ÙˆØ§Ø²ÛŒ
   49 |   // ------------------------------------
   50 |   for (const page of adminPages) {
   51 |     test(`Ø¨Ø±Ø±Ø³ÛŒ ØµÙØ­Ù‡: ${page.name}`, async ({ browser }) => {
   52 |       // Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ù†ØªÚ©Ø³Øª Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù‡Ø± ØªØ³Øª
   53 |       const context = await browser.newContext({
   54 |         recordVideo: {
   55 |           dir: './test-results/videos/',
   56 |           size: { width: 1920, height: 1080 }
   57 |         },
   58 |         viewport: { width: 1920, height: 1080 },
   59 |         ignoreHTTPSErrors: true
   60 |       });
   61 |       
   62 |       // Ø§ÛŒØ¬Ø§Ø¯ ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† ØªØ³Øª
   63 |       const testPage = await context.newPage();
   64 |       
   65 |       try {
   66 |         console.log(`ğŸ”‘ Ø¯Ø± Ø­Ø§Ù„ Ù„Ø§Ú¯ÛŒÙ† Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø±Ø§ÛŒ ØµÙØ­Ù‡: ${page.name}`);
   67 |         await loginAs(testPage, 'admin');
   68 |         
   69 |         // Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ù„Ø§Ú¯ÛŒÙ†
   70 |         await expect(testPage).toHaveURL(/.*\/admin\/dashboard/);
   71 |         console.log('âœ… Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
   72 |         
   73 |         console.log(`ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ ØµÙØ­Ù‡: ${page.name}`);
   74 |         
   75 |         // ØªÙ†Ø¸ÛŒÙ… Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒØªØ± Ø¨Ø±Ø§ÛŒ Ù†Ø§ÙˆØ¨Ø±ÛŒ
   76 |         testPage.setDefaultNavigationTimeout(navigationTimeout);
   77 |         testPage.setDefaultTimeout(pageTimeout);
   78 |         
   79 |         // Ø±ÙØªÙ† Ø¨Ù‡ ØµÙØ­Ù‡ Ø¨Ø§ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒØªØ±
   80 |         await testPage.goto(page.path, { 
   81 |           waitUntil: 'networkidle',
   82 |           timeout: navigationTimeout
   83 |         });
   84 |         
   85 |         // Ø§Ù†ØªØ¸Ø§Ø± Ø¨ÛŒØ´ØªØ± Ø¨Ø±Ø§ÛŒ Ù„ÙˆØ¯ Ø´Ø¯Ù† Ú©Ø§Ù…Ù„ ØµÙØ­Ø§Øª
   86 |         await testPage.waitForLoadState('domcontentloaded');
   87 |         await testPage.waitForLoadState('networkidle');
   88 |         
   89 |         // ØµØ¨Ø± Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ø§Øª Ø³Ù†Ú¯ÛŒÙ†
   90 |         if (page.name === 'Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª') {
   91 |           await testPage.waitForTimeout(5000); // 5 Ø«Ø§Ù†ÛŒÙ‡ ØµØ¨Ø± Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ ØµÙØ­Ø§Øª Ù…Ù‡Ù…
   92 |         }
   93 |         
   94 |         // Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øª
   95 |         const status = await testPage.evaluate(() => document.readyState);
   96 |         expect(status).toBe('complete');
   97 |         
   98 |         // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù…Ø­ØªÙˆØ§ Ø¯Ø± ØµÙØ­Ù‡
   99 |         const hasContent = await testPage.evaluate(() => {
  100 |           const bodyContent = document.body?.textContent || '';
  101 |           return bodyContent.length > 100 && 
  102 |             !bodyContent.includes('Ø®Ø·Ø§ÛŒ 404') && 
  103 |             !bodyContent.includes('500 Internal Server Error');
  104 |         });
  105 |         expect(hasContent).toBeTruthy();
  106 |         
  107 |         // Ú¯Ø±ÙØªÙ† Ø§Ø³Ú©Ø±ÛŒÙ†â€ŒØ´Ø§Øª
  108 |         await testPage.screenshot({ 
  109 |           path: `./test-results/screenshots/${page.path.split('/').pop()}.png`,
  110 |           fullPage: true
  111 |         });
  112 |         
  113 |         console.log(`âœ… ØµÙØ­Ù‡ ${page.name} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø¯`);
  114 |         
  115 |         // Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¯Ø± Ù¾Ø§ÛŒØ§Ù† Ù‡Ø± ØªØ³Øª
  116 |         console.log('ğŸšª Ø¯Ø± Ø­Ø§Ù„ Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³ÛŒØ³ØªÙ…...');
  117 |         
  118 |         // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¢ÙˆØ§ØªØ§Ø± Ú©Ø§Ø±Ø¨Ø±
  119 |         await testPage.locator('img[src*="avatar/man.svg"]').click();
  120 |         
  121 |         // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø®Ø±ÙˆØ¬
  122 |         await testPage.locator('div.text:has-text("Ø®Ø±ÙˆØ¬")').click();
  123 |         
  124 |         // Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯â€ŒØ§ÙˆØª
  125 |         await testPage.waitForLoadState('networkidle');
  126 |         
  127 |         // Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ù„Ø§Ú¯â€ŒØ§ÙˆØª
  128 |         const url = testPage.url();
> 129 |         expect(url).toContain('/login');
      |                     ^ Error: expect(received).toContain(expected) // indexOf
  130 |         console.log('âœ… Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
  131 |         
  132 |       } catch (error) {
  133 |         console.error(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ ØµÙØ­Ù‡ ${page.name}:`, error);
  134 |         
  135 |         // Ø§Ø³Ú©Ø±ÛŒÙ†â€ŒØ´Ø§Øª Ø¯Ø± ØµÙˆØ±Øª Ø®Ø·Ø§
  136 |         await testPage.screenshot({ 
  137 |           path: `./test-results/errors/${page.path.split('/').pop()}-error.png`,
  138 |           fullPage: true 
  139 |         });
  140 |         
  141 |         throw error;
  142 |       } finally {
  143 |         // Ø¨Ø³ØªÙ† Ú©Ø§Ù†ØªÚ©Ø³Øª Ø¯Ø± Ù‡Ø± ØµÙˆØ±Øª
  144 |         await context.close();
  145 |       }
  146 |     });
  147 |   }
  148 | });
  149 |
  150 |
```